{"version":3,"file":"UserManagement-B5rVV3WI.js","names":[],"sources":["../../src/pages/admin/UserManagement.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport { getAllProfiles, updateUserRole } from '@/services/admin'\nimport { UserProfile } from '@/types'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { useToast } from '@/hooks/use-toast'\nimport { useAuth } from '@/hooks/use-auth'\nimport { useNavigate } from 'react-router-dom'\n\nexport default function UserManagement() {\n  const [profiles, setProfiles] = useState<UserProfile[]>([])\n  const [loading, setLoading] = useState(true)\n  const { toast } = useToast()\n  const { user, role } = useAuth()\n  const navigate = useNavigate()\n\n  useEffect(() => {\n    if (role && role !== 'super_admin') {\n      toast({\n        title: 'Access Denied',\n        description: 'You do not have permission to view this page.',\n        variant: 'destructive',\n      })\n      navigate('/admin')\n    }\n  }, [role, navigate, toast])\n\n  const loadProfiles = async () => {\n    setLoading(true)\n    try {\n      const data = await getAllProfiles()\n      setProfiles(data || [])\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to load user profiles',\n        variant: 'destructive',\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    if (role === 'super_admin') {\n      loadProfiles()\n    }\n  }, [role])\n\n  const handleRoleChange = async (userId: string, newRole: string) => {\n    try {\n      await updateUserRole(userId, newRole)\n      setProfiles((prev) =>\n        prev.map((p) => (p.id === userId ? { ...p, role: newRole as any } : p)),\n      )\n      toast({ title: 'Success', description: 'User role updated' })\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to update role',\n        variant: 'destructive',\n      })\n    }\n  }\n\n  if (role !== 'super_admin') return null\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h1 className=\"text-3xl font-bold\">User Management</h1>\n        <p className=\"text-muted-foreground\">\n          Manage user roles and permissions.\n        </p>\n      </div>\n\n      <div className=\"border rounded-md\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>User ID</TableHead>\n              <TableHead>Joined</TableHead>\n              <TableHead>Current Role</TableHead>\n              <TableHead>Actions</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {loading ? (\n              <TableRow>\n                <TableCell colSpan={4} className=\"text-center py-8\">\n                  Loading users...\n                </TableCell>\n              </TableRow>\n            ) : profiles.length === 0 ? (\n              <TableRow>\n                <TableCell colSpan={4} className=\"text-center py-8\">\n                  No users found.\n                </TableCell>\n              </TableRow>\n            ) : (\n              profiles.map((profile) => (\n                <TableRow key={profile.id}>\n                  <TableCell className=\"font-mono text-xs\">\n                    {profile.id}\n                    {profile.id === user?.id && (\n                      <Badge variant=\"secondary\" className=\"ml-2\">\n                        You\n                      </Badge>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    {new Date(profile.created_at).toLocaleDateString()}\n                  </TableCell>\n                  <TableCell>\n                    <Badge variant=\"outline\">{profile.role || 'user'}</Badge>\n                  </TableCell>\n                  <TableCell>\n                    <Select\n                      defaultValue={profile.role || 'user'}\n                      onValueChange={(val) => handleRoleChange(profile.id, val)}\n                      disabled={profile.id === user?.id}\n                    >\n                      <SelectTrigger className=\"w-[140px]\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"user\">User</SelectItem>\n                        <SelectItem value=\"editor\">Editor</SelectItem>\n                        <SelectItem value=\"admin\">Admin</SelectItem>\n                        <SelectItem value=\"super_admin\">Super Admin</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </TableCell>\n                </TableRow>\n              ))\n            )}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  )\n}\n"],"mappings":"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"}
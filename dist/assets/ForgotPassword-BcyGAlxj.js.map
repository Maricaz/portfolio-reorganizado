{"version":3,"file":"ForgotPassword-BcyGAlxj.js","names":["err: any"],"sources":["../../src/pages/admin/ForgotPassword.tsx"],"sourcesContent":["import { useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport { useAuth } from '@/hooks/use-auth'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport * as z from 'zod'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n  CardFooter,\n} from '@/components/ui/card'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\nimport { Loader2, ArrowLeft, CheckCircle } from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { logSecurityEvent, triggerSecurityAlert } from '@/services/security'\n\nconst formSchema = z.object({\n  email: z.string().email({\n    message: 'Por favor, insira um email válido.',\n  }),\n})\n\nexport default function ForgotPassword() {\n  const [submitted, setSubmitted] = useState(false)\n  const [serverError, setServerError] = useState<string | null>(null)\n  const { resetPassword } = useAuth()\n\n  const form = useForm<z.infer<typeof formSchema>>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      email: '',\n    },\n  })\n\n  const { isSubmitting } = form.formState\n\n  const onSubmit = async (values: z.infer<typeof formSchema>) => {\n    setServerError(null)\n\n    try {\n      const { error } = await resetPassword(values.email)\n      if (error) throw error\n\n      setSubmitted(true)\n\n      // Audit and Alert\n      // We log this asynchronously to not block the UI\n      logSecurityEvent('PASSWORD_RECOVERY_REQUEST', { email: values.email })\n      // Only trigger alert if we want to notify admins about recovery requests (optional)\n      // triggerSecurityAlert('PASSWORD_RESET', ...)\n    } catch (err: any) {\n      // Per security best practices, we might want to show success even on failure\n      // if it's related to \"user not found\", but for technical errors, we show the message.\n      // Supabase generally doesn't reveal if user exists in resetPasswordForEmail unless config allows.\n      // However, if there's a network error or rate limit, we should tell the user.\n      setServerError(err.message || 'Ocorreu um erro ao enviar o email.')\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/20 p-4 animate-fade-in\">\n      <Card className=\"w-full max-w-md shadow-lg border-primary/10\">\n        <CardHeader className=\"space-y-1\">\n          <CardTitle className=\"text-2xl font-bold text-center\">\n            Recuperar Senha\n          </CardTitle>\n          <CardDescription className=\"text-center\">\n            Digite seu email para receber o link de redefinição\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          {submitted ? (\n            <div className=\"text-center space-y-4 py-4 animate-fade-in\">\n              <div className=\"mx-auto w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center\">\n                <CheckCircle className=\"w-6 h-6 text-green-600 dark:text-green-500\" />\n              </div>\n              <div className=\"space-y-2\">\n                <h3 className=\"font-semibold text-lg\">Verifique seu email</h3>\n                <p className=\"text-sm text-muted-foreground\">\n                  Se um conta existir com o email{' '}\n                  <strong>{form.getValues('email')}</strong>, você receberá\n                  instruções para redefinir sua senha em breve.\n                </p>\n              </div>\n              <Button\n                variant=\"outline\"\n                className=\"w-full mt-4\"\n                onClick={() => setSubmitted(false)}\n              >\n                Tentar outro email\n              </Button>\n            </div>\n          ) : (\n            <Form {...form}>\n              <form\n                onSubmit={form.handleSubmit(onSubmit)}\n                className=\"space-y-4\"\n              >\n                {serverError && (\n                  <Alert variant=\"destructive\">\n                    <AlertDescription>{serverError}</AlertDescription>\n                  </Alert>\n                )}\n                <FormField\n                  control={form.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"admin@exemplo.com\"\n                          type=\"email\"\n                          autoComplete=\"email\"\n                          disabled={isSubmitting}\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <Button\n                  type=\"submit\"\n                  className=\"w-full\"\n                  disabled={isSubmitting}\n                >\n                  {isSubmitting ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Enviando...\n                    </>\n                  ) : (\n                    'Enviar Link de Recuperação'\n                  )}\n                </Button>\n              </form>\n            </Form>\n          )}\n        </CardContent>\n        <CardFooter className=\"justify-center border-t p-4 bg-muted/10\">\n          <Link\n            to=\"/admin/login\"\n            className={cn(\n              'flex items-center text-sm text-muted-foreground hover:text-primary transition-colors',\n              isSubmitting && 'pointer-events-none opacity-50',\n            )}\n          >\n            <ArrowLeft className=\"mr-2 h-4 w-4\" />\n            Voltar para o Login\n          </Link>\n        </CardFooter>\n      </Card>\n    </div>\n  )\n}\n"],"mappings":"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"}
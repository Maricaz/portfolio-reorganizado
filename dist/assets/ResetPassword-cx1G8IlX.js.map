{"version":3,"file":"ResetPassword-cx1G8IlX.js","names":["err: any"],"sources":["../../src/pages/admin/ResetPassword.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { useAuth } from '@/hooks/use-auth'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\nimport { Loader2, Lock, CheckCircle } from 'lucide-react'\nimport { useToast } from '@/hooks/use-toast'\n\nexport default function ResetPassword() {\n  const [password, setPassword] = useState('')\n  const [confirmPassword, setConfirmPassword] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [success, setSuccess] = useState(false)\n  const { updatePassword, session } = useAuth()\n  const navigate = useNavigate()\n  const { toast } = useToast()\n\n  // Redirect if no session (invalid link or expired)\n  useEffect(() => {\n    // We give a small delay to allow session restore\n    const timer = setTimeout(() => {\n      if (!session) {\n        toast({\n          title: 'Link inválido ou expirado',\n          description: 'Por favor, solicite uma nova redefinição de senha.',\n          variant: 'destructive',\n        })\n        navigate('/admin/login')\n      }\n    }, 2000)\n    return () => clearTimeout(timer)\n  }, [session, navigate, toast])\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setLoading(true)\n    setError(null)\n\n    if (password !== confirmPassword) {\n      setError('As senhas não coincidem.')\n      setLoading(false)\n      return\n    }\n\n    if (password.length < 6) {\n      setError('A senha deve ter pelo menos 6 caracteres.')\n      setLoading(false)\n      return\n    }\n\n    try {\n      const { error } = await updatePassword(password)\n      if (error) throw error\n      setSuccess(true)\n      toast({\n        title: 'Senha atualizada',\n        description: 'Sua senha foi redefinida com sucesso.',\n      })\n      setTimeout(() => {\n        navigate('/admin/login')\n      }, 3000)\n    } catch (err: any) {\n      setError(err.message || 'Erro ao atualizar a senha.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-muted/20 p-4 animate-fade-in\">\n        <Card className=\"w-full max-w-md shadow-lg border-green-200\">\n          <CardContent className=\"pt-6 text-center space-y-4\">\n            <div className=\"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center\">\n              <CheckCircle className=\"w-8 h-8 text-green-600\" />\n            </div>\n            <h2 className=\"text-2xl font-bold text-green-700\">Sucesso!</h2>\n            <p className=\"text-muted-foreground\">\n              Sua senha foi atualizada. Você será redirecionado para o login em\n              instantes.\n            </p>\n            <Button\n              className=\"w-full mt-4\"\n              onClick={() => navigate('/admin/login')}\n            >\n              Ir para Login agora\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/20 p-4 animate-fade-in\">\n      <Card className=\"w-full max-w-md shadow-lg border-primary/10\">\n        <CardHeader className=\"space-y-1\">\n          <CardTitle className=\"text-2xl font-bold text-center\">\n            Redefinir Senha\n          </CardTitle>\n          <CardDescription className=\"text-center\">\n            Digite sua nova senha abaixo\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Nova Senha</Label>\n              <div className=\"relative\">\n                <Lock className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  placeholder=\"******\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                  disabled={loading}\n                  className=\"pl-9\"\n                />\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"confirmPassword\">Confirmar Senha</Label>\n              <div className=\"relative\">\n                <Lock className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  id=\"confirmPassword\"\n                  type=\"password\"\n                  placeholder=\"******\"\n                  value={confirmPassword}\n                  onChange={(e) => setConfirmPassword(e.target.value)}\n                  required\n                  disabled={loading}\n                  className=\"pl-9\"\n                />\n              </div>\n            </div>\n            <Button type=\"submit\" className=\"w-full\" disabled={loading}>\n              {loading ? (\n                <>\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  Atualizando...\n                </>\n              ) : (\n                'Atualizar Senha'\n              )}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"mappings":"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"}
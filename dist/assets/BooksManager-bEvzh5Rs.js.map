{"version":3,"file":"BooksManager-bEvzh5Rs.js","names":[],"sources":["../../src/pages/admin/BooksManager.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport {\n  getAllBooks,\n  createBook,\n  updateBook,\n  deleteBook,\n} from '@/services/books'\nimport { Book } from '@/types'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table'\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog'\nimport { useToast } from '@/hooks/use-toast'\nimport { Plus, Pencil, Trash, Search } from 'lucide-react'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\n\nexport default function BooksManager() {\n  const [books, setBooks] = useState<Book[]>([])\n  const [isOpen, setIsOpen] = useState(false)\n  const [editingBook, setEditingBook] = useState<Partial<Book> | null>(null)\n  const [search, setSearch] = useState('')\n  const { toast } = useToast()\n\n  const loadBooks = async () => {\n    try {\n      const data = await getAllBooks()\n      setBooks(data || [])\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to load books',\n        variant: 'destructive',\n      })\n    }\n  }\n\n  useEffect(() => {\n    loadBooks()\n  }, [])\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    try {\n      if (editingBook?.id) {\n        await updateBook(editingBook.id, editingBook)\n        toast({ title: 'Success', description: 'Book updated' })\n      } else {\n        await createBook(editingBook as Book)\n        toast({ title: 'Success', description: 'Book created' })\n      }\n      setIsOpen(false)\n      loadBooks()\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Operation failed',\n        variant: 'destructive',\n      })\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('Are you sure?')) return\n    try {\n      await deleteBook(id)\n      toast({ title: 'Success', description: 'Book deleted' })\n      loadBooks()\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to delete',\n        variant: 'destructive',\n      })\n    }\n  }\n\n  const filteredBooks = books.filter((b) =>\n    b.title.toLowerCase().includes(search.toLowerCase()),\n  )\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h1 className=\"text-3xl font-bold\">Books Manager</h1>\n        <Dialog open={isOpen} onOpenChange={setIsOpen}>\n          <DialogTrigger asChild>\n            <Button onClick={() => setEditingBook({})}>\n              <Plus className=\"mr-2 h-4 w-4\" /> Add Book\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle>\n                {editingBook?.id ? 'Edit Book' : 'Add Book'}\n              </DialogTitle>\n            </DialogHeader>\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Title</Label>\n                  <Input\n                    value={editingBook?.title || ''}\n                    onChange={(e) =>\n                      setEditingBook({ ...editingBook, title: e.target.value })\n                    }\n                    required\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Author</Label>\n                  <Input\n                    value={editingBook?.author || ''}\n                    onChange={(e) =>\n                      setEditingBook({ ...editingBook, author: e.target.value })\n                    }\n                    required\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Category</Label>\n                  <Input\n                    value={editingBook?.category || ''}\n                    onChange={(e) =>\n                      setEditingBook({\n                        ...editingBook,\n                        category: e.target.value,\n                      })\n                    }\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Language Code (pt/en/ko)</Label>\n                  <Input\n                    value={editingBook?.language_code || ''}\n                    onChange={(e) =>\n                      setEditingBook({\n                        ...editingBook,\n                        language_code: e.target.value,\n                      })\n                    }\n                    required\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Image URL</Label>\n                  <Input\n                    value={editingBook?.image_url || ''}\n                    onChange={(e) =>\n                      setEditingBook({\n                        ...editingBook,\n                        image_url: e.target.value,\n                      })\n                    }\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Original Title</Label>\n                  <Input\n                    value={editingBook?.original_title || ''}\n                    onChange={(e) =>\n                      setEditingBook({\n                        ...editingBook,\n                        original_title: e.target.value,\n                      })\n                    }\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Synopsis</Label>\n                <Textarea\n                  value={editingBook?.synopsis || ''}\n                  onChange={(e) =>\n                    setEditingBook({ ...editingBook, synopsis: e.target.value })\n                  }\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Curation Note</Label>\n                <Textarea\n                  value={editingBook?.curation || ''}\n                  onChange={(e) =>\n                    setEditingBook({ ...editingBook, curation: e.target.value })\n                  }\n                />\n              </div>\n              <Button type=\"submit\" className=\"w-full\">\n                Save\n              </Button>\n            </form>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <Search className=\"h-4 w-4 text-muted-foreground\" />\n        <Input\n          placeholder=\"Search books...\"\n          className=\"max-w-sm\"\n          value={search}\n          onChange={(e) => setSearch(e.target.value)}\n        />\n      </div>\n\n      <div className=\"border rounded-md\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>Title</TableHead>\n              <TableHead>Author</TableHead>\n              <TableHead>Lang</TableHead>\n              <TableHead>Actions</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {filteredBooks.map((book) => (\n              <TableRow key={book.id}>\n                <TableCell className=\"font-medium\">{book.title}</TableCell>\n                <TableCell>{book.author}</TableCell>\n                <TableCell>{book.language_code}</TableCell>\n                <TableCell className=\"flex gap-2\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    onClick={() => {\n                      setEditingBook(book)\n                      setIsOpen(true)\n                    }}\n                  >\n                    <Pencil className=\"h-4 w-4\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"text-destructive\"\n                    onClick={() => handleDelete(book.id)}\n                  >\n                    <Trash className=\"h-4 w-4\" />\n                  </Button>\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  )\n}\n"],"mappings":"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"}